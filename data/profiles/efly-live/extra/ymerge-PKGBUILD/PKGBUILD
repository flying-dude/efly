# SPDX-License-Identifier: BSD-2-Clause

pkgname=ymerge
pkgver="0.0.7"
pkgrel=1
pkgdesc="A Source-Based Package Manager for Arch Linux."
arch=(x86_64)
url="https://github.com/flying-dude/ymerge/"
license=(BSD)
depends=(pacman fmt git abseil-cpp)
makedepends=(cmake fmt nlohmann-json ninja)
provides=(ymerge)

source=(
    "https://github.com/flying-dude/ymerge/archive/refs/tags/${pkgver}.zip"
)

b2sums=('0bf4dc9fda84f4526f3c40b125dc427c2d3487765b9072f416efcd4c5abfc24d6170cfceab9c18575611b68dcf6e96235b8841a557025fd719eba772d6badc12')

build() {
    cd ymerge-*

    cmake -S . -B build -GNinja \
        -DCMAKE_BUILD_TYPE=Release \
        -DCMAKE_SKIP_RPATH=On \
        -DYMERGE_VERSION="${pkgver}" \
        -DCMAKE_INSTALL_PREFIX:PATH='/usr'

    cmake --build build
}

package() {
    cd ymerge-*/build/
    DESTDIR="${pkgdir}" ninja install
}
