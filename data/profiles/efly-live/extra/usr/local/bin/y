#!/usr/bin/fish
# SPDX-License-Identifier: 0BSD

# sudo wrapper around ymerge.

# parse arguments. note that "argparse" will conveniently remove parsed arguments
# from $argv and leave the remaining arguments intact: y -y fish firefox htop => fish firefox htop
argparse h/help y/yes -- $argv
or exit 1 # exit if argparse failed because it found an option it didn't recognize - it will print an error

# print help and exit
if set -q _flag_help
    echo \
"Usage: y [-h|--help] [PACKAGES...]

Wrapper script around ymerge, that runs it with sudo.
Does a system upgrade on empty input.

Examples:
    \$ y         # sudo ymerge --sync --update
    \$ y firefox # sudo ymerge firefox"
    exit 0
end

# perform system upgrade, if no arguments are given
if test (count $argv) -lt 1
    sudo ymerge --sync --update
    exit $status
end

sudo ymerge $argv
exit $status
